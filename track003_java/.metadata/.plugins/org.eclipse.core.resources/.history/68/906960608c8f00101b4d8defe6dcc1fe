package com.company.java006;

import java.time.LocalTime;
import java.util.Scanner;

public class Bank100_control {
    public static void main(String[] args) {
        int num = -1;
        String id = "", pass = "";
        double balance = 0;
        Scanner scanner = new Scanner(System.in);

        for (;;) {
            System.out.print("\n\n== BANK ==");
            System.out.print(
                "\n1. 추가" +
                "\n2. 조회" +
                "\n3. 입금" +
                "\n4. 출금" +
                "\n5. 삭제" +
                "\n6. 타행 이체" +  // 새 메뉴 추가
                "\n9. 종료 > "
            );
            num = scanner.nextInt();

            if (num == 9) {
                System.out.println("종료합니다.");
                break;
            } else if (num == 1) {
                System.out.print("ID 입력 > "); id = scanner.next();
                System.out.print("PASS 입력 > "); pass = scanner.next();
                System.out.print("잔액 입력 > "); balance = scanner.nextDouble();
            } else if (num == 2 || num == 3 || num == 4 || num == 5 || num == 6) {
                // 사용자 인증
                System.out.print("ID 입력 > "); String tempId = scanner.next();
                System.out.print("PASS 입력 > "); String tempPass = scanner.next();
                if (!(id.equals(tempId) && pass.equals(tempPass))) {
                    System.out.println("아이디와 비밀번호를 확인해주세요!");
                    continue;
                }

                switch (num) {
                    case 2:
                        // 조회
                        System.out.println("\nID > " + id + "\nPASS > " + pass + "\n잔액 > " + balance);
                        break;

                    case 3:
                        // 입금
                        System.out.print("입금할 금액 > ");
                        double inAmt = scanner.nextDouble();
                        double feeRateIn = 0.05;  // 입금 기본 수수료 5%
                        double feeIn = inAmt * feeRateIn;
                        double netIn = inAmt - feeIn;

                        balance += netIn;
                        System.out.println("입금 완료. 수수료: " + feeIn + "원, 실제 입금된 금액: " + netIn + "원");
                        break;

                    case 4:
                        // 출금
                        System.out.print("출금할 금액 > ");
                        double outAmt = scanner.nextDouble();
                        if (outAmt > balance) {
                            System.out.println("잔액이 모자랍니다.");
                            continue;
                        }

                        // 시간 확인
                        LocalTime now = LocalTime.now();
                        boolean isNight = (now.isAfter(LocalTime.of(22, 0)) || now.isBefore(LocalTime.of(6, 0)));
                        double feeRateOut = isNight ? 0.10 : 0.05;  // 밤이면 10%, 아니면 기본 5%
                        double feeOut = outAmt * feeRateOut;
                        double totalDeduct = outAmt + feeOut;

                        if (totalDeduct > balance) {
                            System.out.println("수수료 포함 출금 후 잔액이 부족합니다.");
                            continue;
                        }

                        balance -= totalDeduct;
                        System.out.println(
                            "출금 완료. 출금액: " + outAmt +
                            "원, 수수료: " + feeOut + "원, 총 차감액: " + totalDeduct + "원" +
                            ", 남은 잔액: " + balance + "원"
                        );
                        break;

                    case 5:
                        // 삭제
                        System.out.println("삭제하시겠습니까? (y/n)");
                        String answer = scanner.next();
                        if (!answer.toLowerCase().equals("y")) {
                            System.out.println("삭제를 취소했습니다.");
                            continue;
                        }
                        id = pass = "";
                        balance = 0;
                        System.out.println("삭제를 완료했습니다.");
                        break;

                    case 6:
                        // 타행 이체
                        System.out.print("이체할 금액 > ");
                        double tranAmt = scanner.nextDouble();
                        if (tranAmt + 1000 > balance) {
                            System.out.println("이체 + 수수료 후 잔액이 부족합니다.");
                            continue;
                        }
                        // 기본 수수료 5%
                        double feeRateTran = 0.05;
                        double feeTran = tranAmt * feeRateTran;
                        double totalTranDeduct = tranAmt + feeTran + 1000;  // 추가 1000원
                        balance -= totalTranDeduct;

                        System.out.println(
                            "타행 이체 완료. 이체금액: " + tranAmt +
                            "원, 기본 수수료: " + feeTran + "원, 타행 추가수수료: 1000원, 총 차감액: " + totalTranDeduct + "원" +
                            ", 남은 잔액: " + balance + "원"
                        );
                        break;

                    default:
                        System.out.println("잘못된 입력입니다.");
                        break;
                }
            } else {
                System.out.println("잘못된 입력입니다.");
            }
        }

        scanner.close();
    }
}
